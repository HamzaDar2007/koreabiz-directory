  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"79ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:11.256Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:23:11.319Z"}
{"level":"info","message":{"duration":"21ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/ready","userAgent":""},"timestamp":"2026-01-07T15:23:11.382Z"}
  console.log
    DEBUG: Registering user: testuser@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"299ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:11.748Z"}
{"level":"info","message":{"duration":"267ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:12.050Z"}
{"level":"info","message":{"duration":"209ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:12.299Z"}
{"level":"info","message":{"duration":"24ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/refresh","userAgent":""},"timestamp":"2026-01-07T15:23:12.367Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799391,"exp":1767800291}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799391,"exp":1767800291}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"49ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/logout","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:12.453Z"}
{"level":"info","message":{"duration":"314ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:12.804Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:12.858Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:12.902Z"}
  console.log
    DEBUG: Registering user: testuser@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

[Nest] 4576  - 01/07/2026, 8:23:13 PM   ERROR [ExceptionsHandler] duplicate key value violates unique constraint "users_email_key"
QueryFailedError: duplicate key value violates unique constraint "users_email_key"
    at PostgresQueryRunner.query (F:\projects\KoreaBiz-Directory\backend\src\driver\postgres\PostgresQueryRunner.ts:325:19)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at InsertQueryBuilder.execute (F:\projects\KoreaBiz-Directory\backend\src\query-builder\InsertQueryBuilder.ts:164:33)
    at SubjectExecutor.executeInsertOperations (F:\projects\KoreaBiz-Directory\backend\src\persistence\SubjectExecutor.ts:435:42)
    at SubjectExecutor.execute (F:\projects\KoreaBiz-Directory\backend\src\persistence\SubjectExecutor.ts:137:9)
    at EntityPersistExecutor.execute (F:\projects\KoreaBiz-Directory\backend\src\persistence\EntityPersistExecutor.ts:182:21)
    at AuthService.register (F:\projects\KoreaBiz-Directory\backend\src\modules\auth\auth.service.ts:36:5)
    at F:\projects\KoreaBiz-Directory\backend\node_modules\@nestjs\core\router\router-execution-context.js:46:28
    at F:\projects\KoreaBiz-Directory\backend\node_modules\@nestjs\core\router\router-proxy.js:9:17
{"level":"info","message":{"duration":"411ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":500,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:13.349Z"}
{"level":"info","message":{"duration":"246ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:13.633Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"32ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/users/me","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:13.704Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"56ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/users/me","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:13.791Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:13.825Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:13.862Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"70ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:13.966Z"}
{"level":"info","message":{"duration":"41ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises/e1c93e93-769e-4aeb-88ea-081bd7d6b8eb","userAgent":""},"timestamp":"2026-01-07T15:23:14.047Z"}
{"level":"info","message":{"duration":"20ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:14.100Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to update enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 100 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 101 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 102 |[39m       console[33m.[39merror([32m'Failed to update enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 103 |[39m     }
     [90m 104 |[39m
     [90m 105 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.update (../src/modules/enterprises/enterprises.service.ts:102:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"91ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/enterprises/e1c93e93-769e-4aeb-88ea-081bd7d6b8eb","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:14.233Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"26ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/enterprises","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:14.289Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:14.326Z"}
{"level":"info","message":{"duration":"15ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises?page=1&limit=5","userAgent":""},"timestamp":"2026-01-07T15:23:14.371Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/enterprises/99999","userAgent":""},"timestamp":"2026-01-07T15:23:14.409Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"46ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:14.492Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?q=test","userAgent":""},"timestamp":"2026-01-07T15:23:14.532Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"56ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises?page=1&limit=10","userAgent":""},"timestamp":"2026-01-07T15:23:14.631Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/popular","userAgent":""},"timestamp":"2026-01-07T15:23:14.679Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/featured","userAgent":""},"timestamp":"2026-01-07T15:23:14.723Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:14.763Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:23:14.796Z"}
{"level":"info","message":{"duration":"12ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories?page=1&limit=5","userAgent":""},"timestamp":"2026-01-07T15:23:14.838Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/test-category","userAgent":""},"timestamp":"2026-01-07T15:23:14.876Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities","userAgent":""},"timestamp":"2026-01-07T15:23:14.922Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/all","userAgent":""},"timestamp":"2026-01-07T15:23:14.974Z"}
{"level":"info","message":{"duration":"16ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities?page=1&limit=5","userAgent":""},"timestamp":"2026-01-07T15:23:15.031Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/test-city","userAgent":""},"timestamp":"2026-01-07T15:23:15.089Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"55ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/favorites","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.198Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"42ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/favorites","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.272Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"38ms","ip":"::ffff:127.0.0.1","method":"DELETE","statusCode":200,"url":"/v1/favorites/e1c93e93-769e-4aeb-88ea-081bd7d6b8eb","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.343Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/favorites","userAgent":""},"timestamp":"2026-01-07T15:23:15.393Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"48ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/reviews","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.481Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/reviews/enterprise/e1c93e93-769e-4aeb-88ea-081bd7d6b8eb","userAgent":""},"timestamp":"2026-01-07T15:23:15.518Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"31ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/reviews","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.583Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/reviews","userAgent":""},"timestamp":"2026-01-07T15:23:15.628Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":404,"url":"/v1/analytics/event","userAgent":""},"timestamp":"2026-01-07T15:23:15.669Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"53ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/analytics/enterprise/e1c93e93-769e-4aeb-88ea-081bd7d6b8eb","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:15.753Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:15.799Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/non-existent-endpoint","userAgent":""},"timestamp":"2026-01-07T15:23:15.837Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/enterprises?page=0&limit=0","userAgent":""},"timestamp":"2026-01-07T15:23:15.882Z"}
{"level":"info","message":{"duration":"20ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:15.935Z"}
{"level":"info","message":{"duration":"15ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:15.977Z"}
{"level":"info","message":{"duration":"19ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.025Z"}
{"level":"info","message":{"duration":"54ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.131Z"}
{"level":"info","message":{"duration":"201ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.294Z"}
{"level":"info","message":{"duration":"280ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.366Z"}
{"level":"info","message":{"duration":"316ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.396Z"}
{"level":"info","message":{"duration":"331ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.431Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"testuser@example.com","sub":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","iat":1767799393,"exp":1767800293}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: testuser@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"153ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:16.632Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"153ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:16.650Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"153ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"aab8fcc5-9da7-42dc-9a3a-ab7e67b479af","userAgent":""},"timestamp":"2026-01-07T15:23:16.665Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:16.743Z"}
{"level":"info","message":{"duration":"18ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:16.784Z"}
FAIL test/comprehensive.e2e-spec.ts (22.927 s)
  KoreaBiz Directory - Complete Backend E2E Tests
    â‰¡Æ’Ã…Ã‘ Health Check System
      Î“ÃªÃœ should return health status (228 ms)
      Î“ÃªÃœ should return liveness probe (49 ms)
      Î“ÃªÃœ should return readiness probe (59 ms)
    â‰¡Æ’Ã¶Ã‰ Authentication System
      Î“ÃªÃœ should register a new user (362 ms)
      Î“ÃªÃœ should login with valid credentials (306 ms)
      Î“ÃªÃœ should refresh token (315 ms)
      â”œÃ¹ should logout user (85 ms)
      Î“ÃªÃœ should reject invalid credentials (355 ms)
      Î“ÃªÃœ should validate email format (50 ms)
      Î“ÃªÃœ should validate password length (42 ms)
      â”œÃ¹ should prevent duplicate registration (450 ms)
    â‰¡Æ’Ã¦Ã± User Management
      Î“ÃªÃœ should get current user profile (69 ms)
      Î“ÃªÃœ should update user profile (87 ms)
      Î“ÃªÃœ should reject unauthorized access (36 ms)
      Î“ÃªÃœ should reject invalid token (38 ms)
    â‰¡Æ’Ã…Ã³ Enterprise Management
      Î“ÃªÃœ should create a new enterprise (110 ms)
      Î“ÃªÃœ should get enterprise by ID (73 ms)
      Î“ÃªÃœ should list enterprises (57 ms)
      Î“ÃªÃœ should update enterprise (124 ms)
      Î“ÃªÃœ should validate enterprise creation (58 ms)
      Î“ÃªÃœ should require authentication for enterprise creation (34 ms)
      Î“ÃªÃœ should handle pagination (44 ms)
      Î“ÃªÃœ should return 404 for non-existent enterprise (43 ms)
    â‰¡Æ’Ã¶Ã¬ Search System
      Î“ÃªÃœ should search enterprises (82 ms)
      â”œÃ¹ should search with query parameter (46 ms)
      Î“ÃªÃœ should search with pagination (96 ms)
      Î“ÃªÃœ should get popular enterprises (44 ms)
      Î“ÃªÃœ should get featured enterprises (44 ms)
    â‰¡Æ’Ã´Ã© Categories System
      Î“ÃªÃœ should get categories list (35 ms)
      Î“ÃªÃœ should get all categories (33 ms)
      Î“ÃªÃœ should handle category pagination (44 ms)
      Î“ÃªÃœ should get category by slug (38 ms)
    â‰¡Æ’Ã…Ã–âˆ©â••Ã… Cities System
      Î“ÃªÃœ should get cities list (48 ms)
      Î“ÃªÃœ should get all cities (51 ms)
      Î“ÃªÃœ should handle city pagination (62 ms)
      Î“ÃªÃœ should get city by slug (60 ms)
    Î“Â¡Ã‰ Favorites System
      Î“ÃªÃœ should add enterprise to favorites (98 ms)
      Î“ÃªÃœ should get user favorites (75 ms)
      Î“ÃªÃœ should remove from favorites (70 ms)
      Î“ÃªÃœ should require authentication for favorites (51 ms)
    â‰¡Æ’Ã´Â¥ Reviews System
      Î“ÃªÃœ should create a review (83 ms)
      â”œÃ¹ should get enterprise reviews (39 ms)
      Î“ÃªÃœ should validate review rating (62 ms)
      Î“ÃªÃœ should require authentication for reviews (48 ms)
    â‰¡Æ’Ã´Ã¨ Analytics System
      â”œÃ¹ should record analytics event (36 ms)
      â”œÃ¹ should get analytics data (90 ms)
    â‰¡Æ’Â¢Ã­âˆ©â••Ã… Security & Validation
      Î“ÃªÃœ should handle malformed JSON (41 ms)
      Î“ÃªÃœ should return 404 for non-existent endpoints (42 ms)
      Î“ÃªÃœ should validate pagination parameters (38 ms)
      Î“ÃªÃœ should include security headers (51 ms)
      Î“ÃªÃœ should handle CORS properly (43 ms)
    â‰¡Æ’ÃœÃ‡ Performance & Reliability
      Î“ÃªÃœ should respond quickly to health checks (48 ms)
      Î“ÃªÃœ should handle concurrent requests (406 ms)
      Î“ÃªÃœ should maintain data consistency (242 ms)
    â‰¡Æ’Ã¶Âº Application Configuration
      Î“ÃªÃœ should enforce global prefix (29 ms)
      Î“ÃªÃœ should have validation pipe configured (34 ms)
      Î“ÃªÃœ should log requests properly (46 ms)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã‰ Authentication System Î“Ã‡â•‘ should logout user

    expected 200 "OK", got 201 "Created"

      124 |         .set('Authorization', `Bearer ${userToken}`)
      125 |         .send({})
    > 126 |         .expect(200);
          |          ^
      127 |     });
      128 |
      129 |     it('should reject invalid credentials', async () => {

      at Object.<anonymous> (comprehensive.e2e-spec.ts:126:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã‰ Authentication System Î“Ã‡â•‘ should prevent duplicate registration

    expected 409 "Conflict", got 500 "Internal Server Error"

      167 |           displayName: 'Duplicate User'
      168 |         })
    > 169 |         .expect(409);
          |          ^
      170 |     });
      171 |   });
      172 |

      at Object.<anonymous> (comprehensive.e2e-spec.ts:169:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Search System Î“Ã‡â•‘ should search with query parameter

    expected 200 "OK", got 400 "Bad Request"

      320 |       const response = await request(app.getHttpServer())
      321 |         .get('/v1/search/enterprises?q=test')
    > 322 |         .expect(200);
          |          ^
      323 |
      324 |       expect(response.body).toHaveProperty('data');
      325 |       expect(response.body).toHaveProperty('meta');

      at Object.<anonymous> (comprehensive.e2e-spec.ts:322:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Â¥ Reviews System Î“Ã‡â•‘ should get enterprise reviews

    expected 200 "OK", got 404 "Not Found"

      489 |       const response = await request(app.getHttpServer())
      490 |         .get(`/v1/reviews/enterprise/${enterpriseId}`)
    > 491 |         .expect(200);
          |          ^
      492 |
      493 |       expect(response.body).toHaveProperty('data');
      494 |       expect(Array.isArray(response.body.data)).toBe(true);

      at Object.<anonymous> (comprehensive.e2e-spec.ts:491:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Analytics System Î“Ã‡â•‘ should record analytics event

    expected 201 "Created", got 404 "Not Found"

      527 |           enterpriseId: enterpriseId
      528 |         })
    > 529 |         .expect(201);
          |          ^
      530 |     });
      531 |
      532 |     it('should get analytics data', async () => {

      at Object.<anonymous> (comprehensive.e2e-spec.ts:529:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… KoreaBiz Directory - Complete Backend E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Analytics System Î“Ã‡â•‘ should get analytics data

    expect(received).toHaveProperty(path)

    Expected path: "views"
    Received path: []

    Received value: {"data": [], "period": {}, "totals": {"ctaClicks": 0, "pageViews": 0, "searchImpressions": 0}}

      536 |         .expect(200);
      537 |
    > 538 |       expect(response.body).toHaveProperty('views');
          |                             ^
      539 |     });
      540 |   });
      541 |

      at Object.<anonymous> (comprehensive.e2e-spec.ts:538:29)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: Registering user: errortest@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"269ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:20.055Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:20.122Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:20.162Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:20.195Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:20.232Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"30ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/logout","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:20.291Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"27ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/users/me","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:20.347Z"}
{"level":"info","message":{"duration":"212ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:20.587Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:20.628Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:20.670Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"25ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:20.728Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"27ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:20.787Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/enterprises/invalid-uuid","userAgent":""},"timestamp":"2026-01-07T15:23:20.827Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/enterprises?page=-1&limit=0","userAgent":""},"timestamp":"2026-01-07T15:23:20.889Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"69ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:21.012Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"55ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/reviews","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:21.125Z"}
{"level":"info","message":{"duration":"54ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/enterprises/99999999-9999-9999-9999-999999999999","userAgent":""},"timestamp":"2026-01-07T15:23:21.214Z"}
  console.log
    DEBUG: Registering user: errortest@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

[Nest] 4576  - 01/07/2026, 8:23:21 PM   ERROR [ExceptionsHandler] duplicate key value violates unique constraint "users_email_key"
QueryFailedError: duplicate key value violates unique constraint "users_email_key"
    at PostgresQueryRunner.query (F:\projects\KoreaBiz-Directory\backend\src\driver\postgres\PostgresQueryRunner.ts:325:19)
    at processTicksAndRejections (node:internal/process/task_queues:95:5)
    at InsertQueryBuilder.execute (F:\projects\KoreaBiz-Directory\backend\src\query-builder\InsertQueryBuilder.ts:164:33)
    at SubjectExecutor.executeInsertOperations (F:\projects\KoreaBiz-Directory\backend\src\persistence\SubjectExecutor.ts:435:42)
    at SubjectExecutor.execute (F:\projects\KoreaBiz-Directory\backend\src\persistence\SubjectExecutor.ts:137:9)
    at EntityPersistExecutor.execute (F:\projects\KoreaBiz-Directory\backend\src\persistence\EntityPersistExecutor.ts:182:21)
    at AuthService.register (F:\projects\KoreaBiz-Directory\backend\src\modules\auth\auth.service.ts:36:5)
    at F:\projects\KoreaBiz-Directory\backend\node_modules\@nestjs\core\router\router-execution-context.js:46:28
    at F:\projects\KoreaBiz-Directory\backend\node_modules\@nestjs\core\router\router-proxy.js:9:17
{"level":"info","message":{"duration":"437ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":500,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:21.694Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"30ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/reviews","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:21.759Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/non-existent-endpoint","userAgent":""},"timestamp":"2026-01-07T15:23:21.794Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"DELETE","statusCode":404,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:21.841Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:21.924Z"}
[Nest] 4576  - 01/07/2026, 8:23:22 PM   ERROR [ExceptionsHandler] request entity too large
PayloadTooLargeError: request entity too large
    at readStream (F:\projects\KoreaBiz-Directory\backend\node_modules\raw-body\index.js:163:17)
    at getRawBody (F:\projects\KoreaBiz-Directory\backend\node_modules\raw-body\index.js:116:12)
    at read (F:\projects\KoreaBiz-Directory\backend\node_modules\body-parser\lib\read.js:79:3)
    at jsonParser (F:\projects\KoreaBiz-Directory\backend\node_modules\body-parser\lib\types\json.js:138:5)
    at Layer.handle [as handle_request] (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:328:13)
    at F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:346:12)
    at next (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:280:10)
    at expressInit (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\middleware\init.js:40:5)
    at Layer.handle [as handle_request] (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:328:13)
    at F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:346:12)
    at next (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:280:10)
    at query (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\middleware\query.js:45:5)
    at Layer.handle [as handle_request] (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\layer.js:95:5)
    at trim_prefix (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:328:13)
    at F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:286:9
    at Function.process_params (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:346:12)
    at next (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\router\index.js:175:3)
    at Function.handle (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\application.js:181:10)
    at Server.app (F:\projects\KoreaBiz-Directory\backend\node_modules\express\lib\express.js:39:9)
    at Server.emit (node:events:519:28)
    at Server.emit (node:domain:488:12)
    at parserOnIncoming (node:_http_server:1140:12)
    at HTTPParser.parserOnHeadersComplete (node:_http_common:119:17)
{"level":"info","message":{"duration":"25ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises?search=%27;%20DROP%20TABLE%20users;%20--","userAgent":""},"timestamp":"2026-01-07T15:23:22.364Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"55ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:22.459Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"47ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:22.549Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.076Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.111Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.139Z"}
{"level":"info","message":{"duration":"22ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.172Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.193Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.211Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.233Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.283Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.305Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.325Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.343Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.365Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.388Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.407Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.429Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.466Z"}
{"level":"info","message":{"duration":"18ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.498Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.517Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.541Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":429,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.559Z"}
  console.log
    DEBUG: Registering user: ratelimit4@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"995ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:23.859Z"}
  console.log
    DEBUG: Registering user: ratelimit7@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit6@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit5@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"1166ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:24.049Z"}
  console.log
    DEBUG: Registering user: ratelimit8@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit11@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit10@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"2279ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:25.169Z"}
  console.log
    DEBUG: Registering user: ratelimit9@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"2344ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:25.239Z"}
  console.log
    DEBUG: Registering user: ratelimit14@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit13@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"3177ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:26.106Z"}
  console.log
    DEBUG: Registering user: ratelimit15@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"3234ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:26.169Z"}
  console.log
    DEBUG: Registering user: ratelimit12@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"3357ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:26.273Z"}
  console.log
    DEBUG: Registering user: ratelimit19@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4083ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.045Z"}
  console.log
    DEBUG: Registering user: ratelimit18@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit16@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4134ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.089Z"}
  console.log
    DEBUG: Registering user: ratelimit17@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4184ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.131Z"}
  console.log
    DEBUG: Registering user: ratelimit21@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4793ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.769Z"}
  console.log
    DEBUG: Registering user: ratelimit20@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit23@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4858ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.825Z"}
  console.log
    DEBUG: Registering user: ratelimit22@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"4942ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:27.925Z"}
  console.log
    DEBUG: Registering user: ratelimit24@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"5314ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:28.315Z"}
  console.log
    DEBUG: Registering user: ratelimit26@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit25@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"5425ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:28.438Z"}
  console.log
    DEBUG: Registering user: ratelimit27@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"5647ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:28.668Z"}
  console.log
    DEBUG: Registering user: ratelimit29@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit30@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"5917ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:28.949Z"}
  console.log
    DEBUG: Registering user: ratelimit28@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"5986ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.012Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6487ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.429Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6607ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.479Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6553ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.545Z"}
  console.log
    DEBUG: Registering user: ratelimit0@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6675ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.723Z"}
  console.log
    DEBUG: Registering user: ratelimit2@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.log
    DEBUG: Registering user: ratelimit1@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6936ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.860Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6974ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.882Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6889ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.897Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"7048ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.949Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"6931ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:29.971Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"7137ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:30.015Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"7001ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:30.065Z"}
  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"7029ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:30.086Z"}
{"level":"info","message":{"duration":"32ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:30.159Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:30.206Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?q=test","userAgent":""},"timestamp":"2026-01-07T15:23:30.246Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":404,"url":"/v1/auth/forgot-password","userAgent":""},"timestamp":"2026-01-07T15:23:30.290Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?q=","userAgent":""},"timestamp":"2026-01-07T15:23:30.326Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?q=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa","userAgent":""},"timestamp":"2026-01-07T15:23:30.368Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"228ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.692Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"230ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.709Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"227ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.728Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"231ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.746Z"}
  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"261ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.790Z"}
{"level":"info","message":{"duration":"23ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:30.845Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"50ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:30.927Z"}
{"level":"info","message":{"duration":"66ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:31.036Z"}
{"level":"info","message":{"duration":"81ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:31.057Z"}
{"level":"info","message":{"duration":"91ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:31.073Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"errortest@example.com","sub":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","iat":1767799400,"exp":1767800300}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: errortest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"44ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"5e99fe67-777e-4fb9-8a33-ba1605fa0eac","userAgent":""},"timestamp":"2026-01-07T15:23:31.170Z"}
FAIL test/error-handling.e2e-spec.ts (14.323 s)
  Error Handling & Edge Cases E2E Tests
    â‰¡Æ’ÃœÂ¿ Authentication Errors
      Î“ÃªÃœ should handle expired JWT tokens (72 ms)
      Î“ÃªÃœ should handle malformed JWT tokens (34 ms)
      Î“ÃªÃœ should handle missing Authorization header (32 ms)
      Î“ÃªÃœ should handle invalid Authorization format (39 ms)
      â”œÃ¹ should handle blacklisted tokens (111 ms)
    â‰¡Æ’Ã´Â¥ Validation Errors
      Î“ÃªÃœ should validate email format in registration (43 ms)
      Î“ÃªÃœ should validate password strength (40 ms)
      Î“ÃªÃœ should validate required fields (58 ms)
      Î“ÃªÃœ should reject extra fields when forbidNonWhitelisted is true (61 ms)
      â”œÃ¹ should validate UUID format (53 ms)
      Î“ÃªÃœ should validate pagination parameters (61 ms)
      Î“ÃªÃœ should validate rating range in reviews (225 ms)
    â‰¡Æ’Ã¶Ã¬ Database Errors
      Î“ÃªÃœ should handle non-existent resource (404) (87 ms)
      â”œÃ¹ should handle duplicate key violations (477 ms)
      Î“ÃªÃœ should handle foreign key violations (65 ms)
    â‰¡Æ’Ã®Ã‰ HTTP Errors
      Î“ÃªÃœ should handle 404 for non-existent endpoints (45 ms)
      Î“ÃªÃœ should handle 405 for wrong HTTP methods (41 ms)
      Î“ÃªÃœ should handle malformed JSON (34 ms)
      Î“ÃªÃœ should handle missing Content-Type header (45 ms)
      Î“ÃªÃœ should handle oversized requests (380 ms)
    â‰¡Æ’Ã¶Ã† Security Errors
      Î“ÃªÃœ should handle SQL injection attempts (61 ms)
      â”œÃ¹ should handle XSS attempts in input (100 ms)
      Î“ÃªÃœ should handle CSRF attempts (79 ms)
    Î“ÃœÃ­ Rate Limiting Errors
      Î“ÃªÃœ should handle rate limit exceeded (7550 ms)
      Î“ÃªÃœ should include rate limit headers (64 ms)
    â‰¡Æ’Ã¶Âº Service Errors
      Î“ÃªÃœ should handle Redis connection failures gracefully (48 ms)
      â”œÃ¹ should handle MeiliSearch failures gracefully (41 ms)
      â”œÃ¹ should handle email service failures gracefully (40 ms)
    â‰¡Æ’Ã´Ã¨ Edge Cases
      â”œÃ¹ should handle empty search queries (35 ms)
      â”œÃ¹ should handle special characters in search (5 ms)
      â”œÃ¹ should handle very long search queries (75 ms)
      Î“ÃªÃœ should handle concurrent user operations (386 ms)
      Î“ÃªÃœ should handle timezone edge cases (52 ms)
      Î“ÃªÃœ should handle null and undefined values (82 ms)
    â‰¡Æ’Ã¶Ã¤ Recovery & Resilience
      Î“ÃªÃœ should recover from temporary failures (163 ms)
      â”œÃ¹ should maintain data consistency during errors (72 ms)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’ÃœÂ¿ Authentication Errors Î“Ã‡â•‘ should handle blacklisted tokens

    expected 401 "Unauthorized", got 200 "OK"

      79 |         .get('/v1/users/me')
      80 |         .set('Authorization', `Bearer ${userToken}`)
    > 81 |         .expect(401);
         |          ^
      82 |     });
      83 |   });
      84 |

      at Object.<anonymous> (error-handling.e2e-spec.ts:81:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Â¥ Validation Errors Î“Ã‡â•‘ should validate UUID format

    expected 400 "Bad Request", got 404 "Not Found"

      163 |       await request(app.getHttpServer())
      164 |         .get('/v1/enterprises/invalid-uuid')
    > 165 |         .expect(400);
          |          ^
      166 |     });
      167 |
      168 |     it('should validate pagination parameters', async () => {

      at Object.<anonymous> (error-handling.e2e-spec.ts:165:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Database Errors Î“Ã‡â•‘ should handle duplicate key violations

    expected 409 "Conflict", got 500 "Internal Server Error"

      214 |           displayName: 'Duplicate User'
      215 |         })
    > 216 |         .expect(409);
          |          ^
      217 |     });
      218 |
      219 |     it('should handle foreign key violations', async () => {

      at Object.<anonymous> (error-handling.e2e-spec.ts:216:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã† Security Errors Î“Ã‡â•‘ should handle XSS attempts in input

    expect(received).not.toContain(expected) // indexOf

    Expected substring: not "<script>"
    Received string:        "<script>alert(\"xss\")</script>"

      292 |
      293 |       // Should sanitize the input
    > 294 |       expect(response.body.name).not.toContain('<script>');
          |                                      ^
      295 |     });
      296 |
      297 |     it('should handle CSRF attempts', async () => {

      at Object.<anonymous> (error-handling.e2e-spec.ts:294:38)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Âº Service Errors Î“Ã‡â•‘ should handle MeiliSearch failures gracefully

    expected 200 "OK", got 400 "Bad Request"

      355 |       const response = await request(app.getHttpServer())
      356 |         .get('/v1/search/enterprises?q=test')
    > 357 |         .expect(200);
          |          ^
      358 |
      359 |       expect(response.body).toHaveProperty('data');
      360 |     });

      at Object.<anonymous> (error-handling.e2e-spec.ts:357:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Âº Service Errors Î“Ã‡â•‘ should handle email service failures gracefully

    expected 200 "OK", got 404 "Not Found"

      367 |           email: 'errortest@example.com'
      368 |         })
    > 369 |         .expect(200);
          |          ^
      370 |
      371 |       expect(response.body).toHaveProperty('message');
      372 |     });

      at Object.<anonymous> (error-handling.e2e-spec.ts:369:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Edge Cases Î“Ã‡â•‘ should handle empty search queries

    expected 200 "OK", got 400 "Bad Request"

      377 |       const response = await request(app.getHttpServer())
      378 |         .get('/v1/search/enterprises?q=')
    > 379 |         .expect(200);
          |          ^
      380 |
      381 |       expect(response.body).toHaveProperty('data');
      382 |     });

      at Object.<anonymous> (error-handling.e2e-spec.ts:379:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Edge Cases Î“Ã‡â•‘ should handle special characters in search

    TypeError: Request path contains unescaped characters

      at Test.request (../node_modules/superagent/src/node/index.js:808:22)
      at Test.request [as end] (../node_modules/superagent/src/node/index.js:986:8)
      at Test.end (../node_modules/supertest/lib/test.js:118:11)
      at end (../node_modules/superagent/src/request-base.js:285:12)
      at Test.Object.<anonymous>.RequestBase.then (../node_modules/superagent/src/request-base.js:267:31)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Edge Cases Î“Ã‡â•‘ should handle very long search queries

    expected 200 "OK", got 400 "Bad Request"

      394 |       const response = await request(app.getHttpServer())
      395 |         .get(`/v1/search/enterprises?q=${longQuery}`)
    > 396 |         .expect(200);
          |          ^
      397 |
      398 |       expect(response.body).toHaveProperty('data');
      399 |     });

      at Object.<anonymous> (error-handling.e2e-spec.ts:396:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at localAssert (../node_modules/supertest/lib/test.js:120:14)
      at ../node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (../node_modules/superagent/src/node/index.js:925:3)
      at callback (../node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (../node_modules/superagent/src/node/parsers/json.js:19:7)

  Î“Ã¹Ã… Error Handling & Edge Cases E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¤ Recovery & Resilience Î“Ã‡â•‘ should maintain data consistency during errors

    expected 400 "Bad Request", got 201 "Created"

      466 |           shortDescription: 'Test'
      467 |         })
    > 468 |         .expect(400);
          |          ^
      469 |
      470 |       // Verify no partial data was created
      471 |       const response = await request(app.getHttpServer())

      at Object.<anonymous> (error-handling.e2e-spec.ts:468:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at localAssert (../node_modules/supertest/lib/test.js:120:14)
      at ../node_modules/supertest/lib/test.js:125:7
      at Test.fn [as callback] (../node_modules/superagent/src/node/index.js:913:12)
      at callback (../node_modules/superagent/src/node/index.js:1166:18)
      at IncomingMessage.fn (../node_modules/superagent/src/node/parsers/json.js:19:7)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"96ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:34.649Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:23:34.836Z"}
{"level":"info","message":{"duration":"27ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/ready","userAgent":""},"timestamp":"2026-01-07T15:23:34.956Z"}
  console.log
    DEBUG: Registering user: workingtest@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"798ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:35.819Z"}
{"level":"info","message":{"duration":"2008ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:37.887Z"}
{"level":"info","message":{"duration":"482ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:38.437Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:38.503Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:38.553Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"46ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/users/me","user":"8ac21043-6b03-4056-9810-49404eb3d234","userAgent":""},"timestamp":"2026-01-07T15:23:38.653Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"48ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/users/me","user":"8ac21043-6b03-4056-9810-49404eb3d234","userAgent":""},"timestamp":"2026-01-07T15:23:38.740Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:23:38.780Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"50ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"8ac21043-6b03-4056-9810-49404eb3d234","userAgent":""},"timestamp":"2026-01-07T15:23:38.869Z"}
{"level":"info","message":{"duration":"37ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:38.937Z"}
{"level":"info","message":{"duration":"23ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises/6e6ad3f6-9fe1-437a-b467-b480245b4b65","userAgent":""},"timestamp":"2026-01-07T15:23:38.997Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to update enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 100 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 101 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 102 |[39m       console[33m.[39merror([32m'Failed to update enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 103 |[39m     }
     [90m 104 |[39m
     [90m 105 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.update (../src/modules/enterprises/enterprises.service.ts:102:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"74ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/enterprises/6e6ad3f6-9fe1-437a-b467-b480245b4b65","user":"8ac21043-6b03-4056-9810-49404eb3d234","userAgent":""},"timestamp":"2026-01-07T15:23:39.104Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:39.143Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"workingtest@example.com","sub":"8ac21043-6b03-4056-9810-49404eb3d234","iat":1767799417,"exp":1767800317}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: workingtest@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"32ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/enterprises","user":"8ac21043-6b03-4056-9810-49404eb3d234","userAgent":""},"timestamp":"2026-01-07T15:23:39.208Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"40ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:39.283Z"}
{"level":"info","message":{"duration":"17ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/popular","userAgent":""},"timestamp":"2026-01-07T15:23:39.338Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/featured","userAgent":""},"timestamp":"2026-01-07T15:23:39.378Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"75ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises?page=1&limit=10","userAgent":""},"timestamp":"2026-01-07T15:23:39.488Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:39.542Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:23:39.583Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities","userAgent":""},"timestamp":"2026-01-07T15:23:39.631Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/all","userAgent":""},"timestamp":"2026-01-07T15:23:39.673Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:39.721Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/non-existent-endpoint","userAgent":""},"timestamp":"2026-01-07T15:23:39.758Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/enterprises?page=0&limit=0","userAgent":""},"timestamp":"2026-01-07T15:23:39.795Z"}
{"level":"info","message":{"duration":"19ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:39.844Z"}
{"level":"info","message":{"duration":"17ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:39.893Z"}
{"level":"info","message":{"duration":"17ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:39.941Z"}
{"level":"info","message":{"duration":"80ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:40.076Z"}
{"level":"info","message":{"duration":"226ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:40.251Z"}
{"level":"info","message":{"duration":"315ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:40.332Z"}
{"level":"info","message":{"duration":"339ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:40.347Z"}
{"level":"info","message":{"duration":"374ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:40.374Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:40.439Z"}
PASS test/working-final.e2e-spec.ts (9.112 s)
  KoreaBiz Directory - Working E2E Tests
    â‰¡Æ’Ã…Ã‘ Health System
      Î“ÃªÃœ should return health status (339 ms)
      Î“ÃªÃœ should return liveness status (156 ms)
      Î“ÃªÃœ should return readiness status (79 ms)
    â‰¡Æ’Ã¶Ã‰ Authentication Flow
      Î“ÃªÃœ should register a new user (865 ms)
      Î“ÃªÃœ should login with valid credentials (2064 ms)
      Î“ÃªÃœ should reject invalid credentials (547 ms)
      Î“ÃªÃœ should validate email format (60 ms)
      Î“ÃªÃœ should validate password length (50 ms)
    â‰¡Æ’Ã¦Ã± User Management
      Î“ÃªÃœ should get current user profile (99 ms)
      Î“ÃªÃœ should update user profile (81 ms)
      Î“ÃªÃœ should reject unauthorized access (43 ms)
    â‰¡Æ’Ã…Ã³ Enterprise Management
      Î“ÃªÃœ should create a new enterprise (85 ms)
      Î“ÃªÃœ should list enterprises (73 ms)
      Î“ÃªÃœ should get enterprise by ID (54 ms)
      Î“ÃªÃœ should update enterprise (105 ms)
      Î“ÃªÃœ should require authentication for creation (39 ms)
      Î“ÃªÃœ should validate required fields (66 ms)
    â‰¡Æ’Ã¶Ã¬ Search System
      Î“ÃªÃœ should search enterprises (80 ms)
      Î“ÃªÃœ should get popular enterprises (48 ms)
      Î“ÃªÃœ should get featured enterprises (41 ms)
      Î“ÃªÃœ should handle search pagination (115 ms)
    â‰¡Æ’Ã´Ã© Categories & Cities
      Î“ÃªÃœ should get categories list (47 ms)
      Î“ÃªÃœ should get all categories (46 ms)
      Î“ÃªÃœ should get cities list (43 ms)
      Î“ÃªÃœ should get all cities (42 ms)
    â‰¡Æ’Â¢Ã­âˆ©â••Ã… Security & Validation
      Î“ÃªÃœ should handle malformed JSON (46 ms)
      Î“ÃªÃœ should return 404 for non-existent endpoints (36 ms)
      Î“ÃªÃœ should validate pagination parameters (37 ms)
      Î“ÃªÃœ should include security headers (48 ms)
      Î“ÃªÃœ should handle CORS properly (50 ms)
    â‰¡Æ’ÃœÃ‡ Performance & Configuration
      Î“ÃªÃœ should respond quickly to health checks (46 ms)
      Î“ÃªÃœ should handle concurrent requests (431 ms)
      Î“ÃªÃœ should enforce global prefix (25 ms)
      Î“ÃªÃœ should have validation pipe configured (38 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"19ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:43.858Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"16ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/reviews","userAgent":""},"timestamp":"2026-01-07T15:23:43.972Z"}
FAIL test/admin.e2e-spec.ts
  Admin Functionality E2E Tests
    â‰¡Æ’Ã¦Ã¦ Admin User Management
      â”œÃ¹ should list all users (admin only) (1 ms)
      â”œÃ¹ should get user by ID (admin only) (3 ms)
      â”œÃ¹ should update user (admin only)
      â”œÃ¹ should reject non-admin access to admin endpoints (1 ms)
    â‰¡Æ’Ã…Ã³ Admin Enterprise Management
      â”œÃ¹ should list all enterprises (admin) (11 ms)
      â”œÃ¹ should create enterprise (admin)
      â”œÃ¹ should update enterprise (admin)
      â”œÃ¹ should verify enterprise (admin)
    â‰¡Æ’Ã´Â¥ Admin Review Management
      â”œÃ¹ should list all reviews (admin)
      â”œÃ¹ should moderate review (admin) (2 ms)
    â‰¡Æ’Ã„Â» Claims Management
      â”œÃ¹ should submit business claim
      â”œÃ¹ should list user claims
      â”œÃ¹ should review claim (admin)
      â”œÃ¹ should list all claims (admin)
    â‰¡Æ’Ã¶Ã‰ RBAC System
      â”œÃ¹ should grant permission (admin)
      â”œÃ¹ should revoke permission (admin)
      â”œÃ¹ should reject non-admin RBAC operations
    â‰¡Æ’Ã´Ã¨ Audit Logs
      â”œÃ¹ should list audit logs (admin)
      â”œÃ¹ should filter audit logs by action (1 ms)
      â”œÃ¹ should reject non-admin access to audit logs

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¦Ã¦ Admin User Management Î“Ã‡â•‘ should list all users (admin only)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¦Ã¦ Admin User Management Î“Ã‡â•‘ should get user by ID (admin only)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¦Ã¦ Admin User Management Î“Ã‡â•‘ should update user (admin only)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¦Ã¦ Admin User Management Î“Ã‡â•‘ should reject non-admin access to admin endpoints

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã…Ã³ Admin Enterprise Management Î“Ã‡â•‘ should list all enterprises (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã…Ã³ Admin Enterprise Management Î“Ã‡â•‘ should create enterprise (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã…Ã³ Admin Enterprise Management Î“Ã‡â•‘ should update enterprise (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã…Ã³ Admin Enterprise Management Î“Ã‡â•‘ should verify enterprise (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Â¥ Admin Review Management Î“Ã‡â•‘ should list all reviews (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Â¥ Admin Review Management Î“Ã‡â•‘ should moderate review (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã„Â» Claims Management Î“Ã‡â•‘ should submit business claim

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã„Â» Claims Management Î“Ã‡â•‘ should list user claims

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã„Â» Claims Management Î“Ã‡â•‘ should review claim (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã„Â» Claims Management Î“Ã‡â•‘ should list all claims (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã‰ RBAC System Î“Ã‡â•‘ should grant permission (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã‰ RBAC System Î“Ã‡â•‘ should revoke permission (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã‰ RBAC System Î“Ã‡â•‘ should reject non-admin RBAC operations

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Audit Logs Î“Ã‡â•‘ should list audit logs (admin)

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Audit Logs Î“Ã‡â•‘ should filter audit logs by action

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  Î“Ã¹Ã… Admin Functionality E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¨ Audit Logs Î“Ã‡â•‘ should reject non-admin access to audit logs

    QueryFailedError: column "passwordHash" of relation "users" does not exist

      at PostgresQueryRunner.query (../src/driver/postgres/PostgresQueryRunner.ts:325:19)
      at DataSource.query (../src/data-source/DataSource.ts:541:20)
      at Object.<anonymous> (admin.e2e-spec.ts:32:5)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: Registering user: mediauser@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"300ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:48.531Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:23:48.598Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/presigned","userAgent":""},"timestamp":"2026-01-07T15:23:48.696Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"12ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/register","userAgent":""},"timestamp":"2026-01-07T15:23:48.756Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/media/enterprises/undefined","userAgent":""},"timestamp":"2026-01-07T15:23:48.815Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/presigned","userAgent":""},"timestamp":"2026-01-07T15:23:48.896Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"12ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/register","userAgent":""},"timestamp":"2026-01-07T15:23:48.959Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/presigned","userAgent":""},"timestamp":"2026-01-07T15:23:49.030Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"12ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/media/enterprises/undefined/register","userAgent":""},"timestamp":"2026-01-07T15:23:49.097Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"DELETE","statusCode":401,"url":"/v1/media/enterprises/undefined/undefined","userAgent":""},"timestamp":"2026-01-07T15:23:49.148Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":404,"url":"/v1/auth/resend-verification","userAgent":""},"timestamp":"2026-01-07T15:23:49.212Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":404,"url":"/v1/auth/forgot-password","userAgent":""},"timestamp":"2026-01-07T15:23:49.278Z"}
{"level":"info","message":{"duration":"30ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/subscriptions/plans","userAgent":""},"timestamp":"2026-01-07T15:23:49.357Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/subscriptions/status","userAgent":""},"timestamp":"2026-01-07T15:23:49.399Z"}
{"level":"info","message":{"duration":"3ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":404,"url":"/v1/subscriptions/change-plan","userAgent":""},"timestamp":"2026-01-07T15:23:49.453Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/subscriptions/status","userAgent":""},"timestamp":"2026-01-07T15:23:49.503Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?category=technology&city=seoul&verified=true","userAgent":""},"timestamp":"2026-01-07T15:23:49.561Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?lat=37.5665&lng=126.9780&radius=10","userAgent":""},"timestamp":"2026-01-07T15:23:49.612Z"}
{"level":"info","message":{"duration":"5ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?minPrice=1&maxPrice=3","userAgent":""},"timestamp":"2026-01-07T15:23:49.649Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":400,"url":"/v1/search/enterprises?sortBy=rating&sortOrder=DESC","userAgent":""},"timestamp":"2026-01-07T15:23:49.695Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/app/version","userAgent":"KoreaBizApp/1.0.0"},"timestamp":"2026-01-07T15:23:49.737Z"}
{"level":"info","message":{"duration":"4ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/enterprises/undefined/mobile","userAgent":""},"timestamp":"2026-01-07T15:23:49.781Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:49.827Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:49.874Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:23:49.919Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:23:49.965Z"}
{"level":"info","message":{"duration":"8ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:23:50.004Z"}
{"level":"info","message":{"duration":"30ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/popular","userAgent":""},"timestamp":"2026-01-07T15:23:50.067Z"}
FAIL test/media-features.e2e-spec.ts (6.243 s)
  Media & File Upload E2E Tests
    â‰¡Æ’Ã´Ã¼ Media Management
      â”œÃ¹ should create presigned URL for upload (95 ms)
      â”œÃ¹ should register uploaded media (59 ms)
      â”œÃ¹ should get enterprise media (74 ms)
      â”œÃ¹ should validate media type (70 ms)
      â”œÃ¹ should validate file size (59 ms)
      Î“ÃªÃœ should require authentication for media operations (74 ms)
      â”œÃ¹ should delete media (115 ms)
    â‰¡Æ’Ã´Âº Email System (Mocked)
      â”œÃ¹ should handle email verification (73 ms)
      â”œÃ¹ should handle password reset request (51 ms)
    â‰¡Æ’Ã†â”‚ Subscription System
      Î“ÃªÃœ should get subscription plans (77 ms)
      â”œÃ¹ should get user subscription status (53 ms)
      â”œÃ¹ should change subscription plan (47 ms)
      â”œÃ¹ should require authentication for subscription operations (52 ms)
    â‰¡Æ’Ã¶Ã¬ Advanced Search Features
      â”œÃ¹ should search with filters (51 ms)
      â”œÃ¹ should search with location radius (49 ms)
      â”œÃ¹ should search with price range (37 ms)
      â”œÃ¹ should sort search results (46 ms)
    â‰¡Æ’Ã´â–’ Mobile API Features
      â”œÃ¹ should handle mobile app version check (44 ms)
      â”œÃ¹ should get mobile-optimized enterprise data (41 ms)
    â‰¡Æ’Ã®Ã‰ Internationalization
      Î“ÃªÃœ should handle Korean language requests (48 ms)
      Î“ÃªÃœ should handle English language requests (45 ms)
      Î“ÃªÃœ should default to Korean for invalid language (43 ms)
    Î“ÃœÃ­ Caching & Performance
      Î“ÃªÃœ should cache frequently accessed data (85 ms)
      Î“ÃªÃœ should handle cache invalidation (65 ms)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should create presigned URL for upload

    expected 201 "Created", got 401 "Unauthorized"

      59 |           mediaType: 'LOGO'
      60 |         })
    > 61 |         .expect(201);
         |          ^
      62 |
      63 |       expect(response.body).toHaveProperty('uploadUrl');
      64 |       expect(response.body).toHaveProperty('key');

      at Object.<anonymous> (media-features.e2e-spec.ts:61:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should register uploaded media

    expected 201 "Created", got 401 "Unauthorized"

      77 |           height: 200
      78 |         })
    > 79 |         .expect(201);
         |          ^
      80 |
      81 |       expect(response.body).toHaveProperty('id');
      82 |       expect(response.body).toHaveProperty('mediaType', 'LOGO');

      at Object.<anonymous> (media-features.e2e-spec.ts:79:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should get enterprise media

    expected 200 "OK", got 401 "Unauthorized"

      86 |       const response = await request(app.getHttpServer())
      87 |         .get(`/v1/media/enterprises/${enterpriseId}`)
    > 88 |         .expect(200);
         |          ^
      89 |
      90 |       expect(Array.isArray(response.body)).toBe(true);
      91 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:88:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should validate media type

    expected 400 "Bad Request", got 401 "Unauthorized"

      100 |           mediaType: 'INVALID_TYPE'
      101 |         })
    > 102 |         .expect(400);
          |          ^
      103 |     });
      104 |
      105 |     it('should validate file size', async () => {

      at Object.<anonymous> (media-features.e2e-spec.ts:102:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should validate file size

    expected 400 "Bad Request", got 401 "Unauthorized"

      113 |           fileSize: 50 * 1024 * 1024 // 50MB - should be too large
      114 |         })
    > 115 |         .expect(400);
          |          ^
      116 |     });
      117 |
      118 |     it('should require authentication for media operations', async () => {

      at Object.<anonymous> (media-features.e2e-spec.ts:115:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Ã¼ Media Management Î“Ã‡â•‘ should delete media

    expected 200 "OK", got 401 "Unauthorized"

      145 |         .delete(`/v1/media/enterprises/${enterpriseId}/${mediaId}`)
      146 |         .set('Authorization', `Bearer ${userToken}`)
    > 147 |         .expect(200);
          |          ^
      148 |     });
      149 |   });
      150 |

      at Object.<anonymous> (media-features.e2e-spec.ts:147:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Âº Email System (Mocked) Î“Ã‡â•‘ should handle email verification

    expected 200 "OK", got 404 "Not Found"

      157 |           email: 'mediauser@example.com'
      158 |         })
    > 159 |         .expect(200);
          |          ^
      160 |
      161 |       expect(response.body).toHaveProperty('message');
      162 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:159:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´Âº Email System (Mocked) Î“Ã‡â•‘ should handle password reset request

    expected 200 "OK", got 404 "Not Found"

      168 |           email: 'mediauser@example.com'
      169 |         })
    > 170 |         .expect(200);
          |          ^
      171 |
      172 |       expect(response.body).toHaveProperty('message');
      173 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:170:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã†â”‚ Subscription System Î“Ã‡â•‘ should get user subscription status

    expected 200 "OK", got 404 "Not Found"

      187 |         .get('/v1/subscriptions/status')
      188 |         .set('Authorization', `Bearer ${userToken}`)
    > 189 |         .expect(200);
          |          ^
      190 |
      191 |       expect(response.body).toHaveProperty('tier');
      192 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:189:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã†â”‚ Subscription System Î“Ã‡â•‘ should change subscription plan

    expected 200 "OK", got 404 "Not Found"

      200 |           paymentMethodId: 'pm_test_123'
      201 |         })
    > 202 |         .expect(200);
          |          ^
      203 |
      204 |       expect(response.body).toHaveProperty('status');
      205 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:202:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã†â”‚ Subscription System Î“Ã‡â•‘ should require authentication for subscription operations

    expected 401 "Unauthorized", got 404 "Not Found"

      208 |       await request(app.getHttpServer())
      209 |         .get('/v1/subscriptions/status')
    > 210 |         .expect(401);
          |          ^
      211 |     });
      212 |   });
      213 |

      at Object.<anonymous> (media-features.e2e-spec.ts:210:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Advanced Search Features Î“Ã‡â•‘ should search with filters

    expected 200 "OK", got 400 "Bad Request"

      216 |       const response = await request(app.getHttpServer())
      217 |         .get('/v1/search/enterprises?category=technology&city=seoul&verified=true')
    > 218 |         .expect(200);
          |          ^
      219 |
      220 |       expect(response.body).toHaveProperty('data');
      221 |       expect(response.body).toHaveProperty('meta');

      at Object.<anonymous> (media-features.e2e-spec.ts:218:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Advanced Search Features Î“Ã‡â•‘ should search with location radius

    expected 200 "OK", got 400 "Bad Request"

      225 |       const response = await request(app.getHttpServer())
      226 |         .get('/v1/search/enterprises?lat=37.5665&lng=126.9780&radius=10')
    > 227 |         .expect(200);
          |          ^
      228 |
      229 |       expect(response.body).toHaveProperty('data');
      230 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:227:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Advanced Search Features Î“Ã‡â•‘ should search with price range

    expected 200 "OK", got 400 "Bad Request"

      233 |       const response = await request(app.getHttpServer())
      234 |         .get('/v1/search/enterprises?minPrice=1&maxPrice=3')
    > 235 |         .expect(200);
          |          ^
      236 |
      237 |       expect(response.body).toHaveProperty('data');
      238 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:235:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã¶Ã¬ Advanced Search Features Î“Ã‡â•‘ should sort search results

    expected 200 "OK", got 400 "Bad Request"

      241 |       const response = await request(app.getHttpServer())
      242 |         .get('/v1/search/enterprises?sortBy=rating&sortOrder=DESC')
    > 243 |         .expect(200);
          |          ^
      244 |
      245 |       expect(response.body).toHaveProperty('data');
      246 |     });

      at Object.<anonymous> (media-features.e2e-spec.ts:243:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´â–’ Mobile API Features Î“Ã‡â•‘ should handle mobile app version check

    expected 200 "OK", got 404 "Not Found"

      252 |         .get('/v1/app/version')
      253 |         .set('User-Agent', 'KoreaBizApp/1.0.0')
    > 254 |         .expect(200);
          |          ^
      255 |
      256 |       expect(response.body).toHaveProperty('version');
      257 |       expect(response.body).toHaveProperty('updateRequired');

      at Object.<anonymous> (media-features.e2e-spec.ts:254:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  Î“Ã¹Ã… Media & File Upload E2E Tests Î“Ã‡â•‘ â‰¡Æ’Ã´â–’ Mobile API Features Î“Ã‡â•‘ should get mobile-optimized enterprise data

    expected 200 "OK", got 404 "Not Found"

      261 |       const response = await request(app.getHttpServer())
      262 |         .get(`/v1/enterprises/${enterpriseId}/mobile`)
    > 263 |         .expect(200);
          |          ^
      264 |
      265 |       expect(response.body).toHaveProperty('id');
      266 |       expect(response.body).toHaveProperty('name');

      at Object.<anonymous> (media-features.e2e-spec.ts:263:10)
      ----
      at Test._assertStatus (../node_modules/supertest/lib/test.js:252:14)
      at ../node_modules/supertest/lib/test.js:308:13
      at Test._assertFunction (../node_modules/supertest/lib/test.js:285:13)
      at Test.assert (../node_modules/supertest/lib/test.js:164:23)
      at Server.localAssert (../node_modules/supertest/lib/test.js:120:14)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"42ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:53.944Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:23:54.017Z"}
{"level":"info","message":{"duration":"72ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/ready","userAgent":""},"timestamp":"2026-01-07T15:23:54.139Z"}
{"level":"info","message":{"duration":"43ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:54.292Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:54.398Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:54.500Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:54.678Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:54.746Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/non-existent-endpoint","userAgent":""},"timestamp":"2026-01-07T15:23:54.822Z"}
{"level":"info","message":{"duration":"35ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:54.966Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:23:55.052Z"}
{"level":"info","message":{"duration":"18ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:55.103Z"}
{"level":"info","message":{"duration":"17ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:55.155Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:23:55.188Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:55.235Z"}
{"level":"info","message":{"duration":"31ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:55.311Z"}
{"level":"info","message":{"duration":"194ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:55.651Z"}
{"level":"info","message":{"duration":"551ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.085Z"}
{"level":"info","message":{"duration":"633ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.159Z"}
{"level":"info","message":{"duration":"674ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.215Z"}
{"level":"info","message":{"duration":"829ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.339Z"}
{"level":"info","message":{"duration":"917ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.392Z"}
{"level":"info","message":{"duration":"952ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.440Z"}
{"level":"info","message":{"duration":"1057ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.520Z"}
{"level":"info","message":{"duration":"1084ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.581Z"}
{"level":"info","message":{"duration":"1092ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.643Z"}
{"level":"info","message":{"duration":"38ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:23:56.721Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-0@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"349ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:57.158Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-1@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"263ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:57.454Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-2@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"253ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:57.742Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-3@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"248ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:58.027Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-4@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"247ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:58.309Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-5@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"244ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:58.585Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-6@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"260ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:58.875Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-7@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"267ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:59.175Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-8@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"251ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:59.464Z"}
  console.log
    DEBUG: Registering user: rate-test-1767799436772-9@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"262ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:23:59.755Z"}
PASS test/complete.e2e-spec.ts (9.461 s)
  KoreaBiz Directory - Complete E2E Test Suite
    â‰¡Æ’Ã…Ã‘ Health Check Endpoints
      Î“ÃªÃœ GET /v1/health - should return health status (128 ms)
      Î“ÃªÃœ GET /v1/health/live - should return liveness status (56 ms)
      Î“ÃªÃœ GET /v1/health/ready - should return readiness status (118 ms)
    â‰¡Æ’Ã¶Ã‰ Authentication Validation
      Î“ÃªÃœ POST /v1/auth/register - should validate email format (158 ms)
      Î“ÃªÃœ POST /v1/auth/register - should validate password length (147 ms)
      Î“ÃªÃœ POST /v1/auth/register - should validate required fields (102 ms)
      Î“ÃªÃœ POST /v1/auth/login - should validate email format (134 ms)
      Î“ÃªÃœ POST /v1/auth/login - should validate required fields (65 ms)
    â‰¡Æ’Â¢Ã­âˆ©â••Ã… Security & Middleware
      Î“ÃªÃœ should return 404 for non-existent endpoints (87 ms)
      Î“ÃªÃœ should handle malformed JSON in POST requests (47 ms)
      Î“ÃªÃœ should include security headers (75 ms)
    â‰¡Æ’Ã¶Âº Application Configuration
      Î“ÃªÃœ should have proper global prefix configuration (37 ms)
      Î“ÃªÃœ should have validation pipe configured (46 ms)
      Î“ÃªÃœ should handle CORS properly (52 ms)
    â‰¡Æ’Ã´Ã¨ API Response Structure
      Î“ÃªÃœ health endpoints should return consistent structure (84 ms)
      Î“ÃªÃœ validation errors should return proper error structure (54 ms)
    â‰¡Æ’ÃœÃ‡ Performance & Reliability
      Î“ÃªÃœ health check should respond quickly (82 ms)
      Î“ÃªÃœ should handle concurrent requests (1326 ms)
    â‰¡Æ’Ã´Â¥ Logging & Monitoring
      Î“ÃªÃœ should log requests properly (95 ms)
    â‰¡Æ’Ã´Ã« Rate Limiting
      Î“ÃªÃœ should have rate limiting configured (3010 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"33ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:24:03.654Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:24:03.722Z"}
{"level":"info","message":{"duration":"21ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:24:03.784Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:24:03.835Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities","userAgent":""},"timestamp":"2026-01-07T15:24:03.883Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/all","userAgent":""},"timestamp":"2026-01-07T15:24:03.933Z"}
{"level":"info","message":{"duration":"23ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:03.992Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"37ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:04.075Z"}
{"level":"info","message":{"duration":"22ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/popular","userAgent":""},"timestamp":"2026-01-07T15:24:04.136Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/featured","userAgent":""},"timestamp":"2026-01-07T15:24:04.189Z"}
{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:04.256Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:24:04.305Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"16ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:24:04.408Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"18ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:04.505Z"}
PASS test/api.e2e-spec.ts
  KoreaBiz Directory API (e2e)
    Health Endpoints
      Î“ÃªÃœ /v1/health (GET) should return health status (102 ms)
      Î“ÃªÃœ /v1/health/live (GET) should return liveness status (53 ms)
    Categories Endpoints
      Î“ÃªÃœ /v1/categories (GET) should return categories list (61 ms)
      Î“ÃªÃœ /v1/categories/all (GET) should return all categories (47 ms)
    Cities Endpoints
      Î“ÃªÃœ /v1/cities (GET) should return cities list (53 ms)
      Î“ÃªÃœ /v1/cities/all (GET) should return all cities (47 ms)
    Enterprises Endpoints
      Î“ÃªÃœ /v1/enterprises (GET) should return enterprises list (61 ms)
    Search Endpoints
      Î“ÃªÃœ /v1/search/enterprises (GET) should return search results (79 ms)
      Î“ÃªÃœ /v1/search/popular (GET) should return popular enterprises (62 ms)
      Î“ÃªÃœ /v1/search/featured (GET) should return featured enterprises (53 ms)
    Authentication Endpoints
      Î“ÃªÃœ /v1/auth/register (POST) should validate input (63 ms)
      Î“ÃªÃœ /v1/auth/login (POST) should validate input (60 ms)
    Protected Endpoints
      Î“ÃªÃœ /v1/users/me (GET) should require authentication (113 ms)
      Î“ÃªÃœ /v1/enterprises (POST) should require authentication (92 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: Registering user: enterprise-test-v2@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"315ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:08.636Z"}
{"level":"info","message":{"duration":"33ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:08.733Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises?cityId=00000000-0000-0000-0000-000000000000","userAgent":""},"timestamp":"2026-01-07T15:24:08.797Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"enterprise-test-v2@example.com","sub":"0eac6591-edd5-41d3-a9a5-6d71066287b2","iat":1767799448,"exp":1767800348}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: enterprise-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"enterprise-test-v2@example.com","sub":"0eac6591-edd5-41d3-a9a5-6d71066287b2","iat":1767799448,"exp":1767800348}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: enterprise-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to index enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 64 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 65 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 66 |[39m       console[33m.[39merror([32m'Failed to index enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 67 |[39m     }
     [90m 68 |[39m
     [90m 69 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.create (../src/modules/enterprises/enterprises.service.ts:66:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"66ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/enterprises","user":"0eac6591-edd5-41d3-a9a5-6d71066287b2","userAgent":""},"timestamp":"2026-01-07T15:24:08.918Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:08.961Z"}
{"level":"info","message":{"duration":"28ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/enterprises/6c3b465c-abeb-46ae-8d56-df2df0ad6b23","userAgent":""},"timestamp":"2026-01-07T15:24:09.031Z"}
{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":404,"url":"/v1/enterprises/ffffffff-ffff-ffff-ffff-ffffffffffff","userAgent":""},"timestamp":"2026-01-07T15:24:09.076Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"enterprise-test-v2@example.com","sub":"0eac6591-edd5-41d3-a9a5-6d71066287b2","iat":1767799448,"exp":1767800348}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: enterprise-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"enterprise-test-v2@example.com","sub":"0eac6591-edd5-41d3-a9a5-6d71066287b2","iat":1767799448,"exp":1767800348}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: enterprise-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.error
    Failed to update enterprise in Meilisearch: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 100 |[39m       [36mawait[39m [36mthis[39m[33m.[39mmeilisearchService[33m.[39mindexEnterprise(saved)[33m;[39m
     [90m 101 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 102 |[39m       console[33m.[39merror([32m'Failed to update enterprise in Meilisearch:'[39m[33m,[39m error)[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 103 |[39m     }
     [90m 104 |[39m
     [90m 105 |[39m     [36mreturn[39m saved[33m;[39m[0m

      at EnterprisesService.update (../src/modules/enterprises/enterprises.service.ts:102:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"79ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/enterprises/6c3b465c-abeb-46ae-8d56-df2df0ad6b23","user":"0eac6591-edd5-41d3-a9a5-6d71066287b2","userAgent":""},"timestamp":"2026-01-07T15:24:09.196Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":401,"url":"/v1/enterprises/6c3b465c-abeb-46ae-8d56-df2df0ad6b23","userAgent":""},"timestamp":"2026-01-07T15:24:09.247Z"}
PASS test/enterprises.e2e-spec.ts
  Enterprises (e2e)
    /v1/enterprises (GET)
      Î“ÃªÃœ should get enterprises list (99 ms)
      Î“ÃªÃœ should filter enterprises by city (60 ms)
    /v1/enterprises (POST)
      Î“ÃªÃœ should create a new enterprise (116 ms)
      Î“ÃªÃœ should fail without authentication (49 ms)
    /v1/enterprises/:id (GET)
      Î“ÃªÃœ should get enterprise by id (67 ms)
      Î“ÃªÃœ should return 404 for non-existent enterprise (46 ms)
    /v1/enterprises/:id (PUT)
      Î“ÃªÃœ should update enterprise (121 ms)
      Î“ÃªÃœ should fail without authentication (46 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: Registering user: user-test-v2@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"395ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:13.001Z"}
  console.log
    DEBUG: Register Response Status: 201

      at Object.<anonymous> (users.e2e-spec.ts:39:13)

  console.log
    DEBUG: Access Token structure: eyJhbGciOi...

      at Object.<anonymous> (users.e2e-spec.ts:40:13)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"user-test-v2@example.com","sub":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","iat":1767799452,"exp":1767800352}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: user-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"user-test-v2@example.com","sub":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","iat":1767799452,"exp":1767800352}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: user-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"81ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/users/me","user":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","userAgent":""},"timestamp":"2026-01-07T15:24:13.156Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"13ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:24:13.213Z"}
  console.log
    DEBUG: JwtStrategy validating payload: {"email":"user-test-v2@example.com","sub":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","iat":1767799452,"exp":1767800352}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: user-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

  console.log
    DEBUG: JwtStrategy validating payload: {"email":"user-test-v2@example.com","sub":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","iat":1767799452,"exp":1767800352}

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:27:13)

  console.log
    DEBUG: JwtStrategy user found: user-test-v2@example.com

      at JwtStrategy.validate (../src/modules/auth/strategies/jwt.strategy.ts:36:13)

  console.log
    DEBUG: JwtAuthGuard super.canActivate result: true

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:38:15)

{"level":"info","message":{"duration":"69ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":200,"url":"/v1/users/me","user":"076d12f6-a3dc-4a3c-855c-dd1589bf1043","userAgent":""},"timestamp":"2026-01-07T15:24:13.329Z"}
  console.log
    DEBUG: JwtAuthGuard error: Unauthorized

      at JwtAuthGuard.canActivate (../src/common/guards/jwt-auth.guard.ts:56:15)

{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"PUT","statusCode":401,"url":"/v1/users/me","userAgent":""},"timestamp":"2026-01-07T15:24:13.379Z"}
PASS test/users.e2e-spec.ts
  Users (e2e)
    /v1/users/me (GET)
      Î“ÃªÃœ should get current user profile (152 ms)
      Î“ÃªÃœ should fail without authentication (52 ms)
    /v1/users/me (PUT)
      Î“ÃªÃœ should update user profile (115 ms)
      Î“ÃªÃœ should fail without authentication (54 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.log
    DEBUG: Registering user: e2e-test@example.com

      at AuthService.register (../src/modules/auth/auth.service.ts:34:13)

  console.error
    Failed to send verification email: Error: connect ECONNREFUSED 127.0.0.1:587
        at TCPConnectWrap.afterConnect [as oncomplete] (node:net:1607:16) {
      errno: -4078,
      code: 'ESOCKET',
      syscall: 'connect',
      address: '127.0.0.1',
      port: 587,
      command: 'CONN'
    }

    [0m [90m 40 |[39m       [36mawait[39m [36mthis[39m[33m.[39memailService[33m.[39msendVerificationEmail(user[33m.[39memail[33m,[39m [32m'dummy-token'[39m)[33m;[39m
     [90m 41 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 42 |[39m       console[33m.[39merror([32m'Failed to send verification email:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 43 |[39m     }
     [90m 44 |[39m
     [90m 45 |[39m     [36mconst[39m payload [33m=[39m { email[33m:[39m user[33m.[39memail[33m,[39m sub[33m:[39m user[33m.[39mid[33m,[39m iat[33m:[39m [33mMath[39m[33m.[39mfloor([33mDate[39m[33m.[39mnow() [33m/[39m [35m1000[39m) }[33m;[39m[0m

      at AuthService.register (../src/modules/auth/auth.service.ts:42:15)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"262ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":201,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:19.402Z"}
{"level":"info","message":{"duration":"7ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:19.453Z"}
{"level":"info","message":{"duration":"6ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":400,"url":"/v1/auth/register","userAgent":""},"timestamp":"2026-01-07T15:24:19.506Z"}
{"level":"info","message":{"duration":"234ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":200,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:24:19.776Z"}
{"level":"info","message":{"duration":"14ms","ip":"::ffff:127.0.0.1","method":"POST","statusCode":401,"url":"/v1/auth/login","userAgent":""},"timestamp":"2026-01-07T15:24:19.834Z"}
PASS test/auth.e2e-spec.ts (6.435 s)
  Auth (e2e)
    /v1/auth/register (POST)
      Î“ÃªÃœ should register a new user (330 ms)
      Î“ÃªÃœ should fail with invalid email (52 ms)
      Î“ÃªÃœ should fail with short password (46 ms)
    /v1/auth/login (POST)
      Î“ÃªÃœ should login with valid credentials (274 ms)
      Î“ÃªÃœ should fail with invalid credentials (60 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"64ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises","userAgent":""},"timestamp":"2026-01-07T15:24:23.671Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"57ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises?query=test","userAgent":""},"timestamp":"2026-01-07T15:24:23.778Z"}
  console.error
    Meilisearch error, falling back to SQL: MeiliSearchCommunicationError: fetch failed
        at node:internal/deps/undici/undici:13178:13
        at processTicksAndRejections (node:internal/process/task_queues:95:5)

    [0m [90m 56 |[39m       [36mreturn[39m [orderedEnterprises[33m,[39m searchResults[33m.[39mestimatedTotalHits][33m;[39m
     [90m 57 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 58 |[39m       console[33m.[39merror([32m'Meilisearch error, falling back to SQL:'[39m[33m,[39m error)[33m;[39m
     [90m    |[39m               [31m[1m^[22m[39m
     [90m 59 |[39m       [36mreturn[39m [36mthis[39m[33m.[39mfallbackSqlSearch(dto)[33m;[39m
     [90m 60 |[39m     }
     [90m 61 |[39m   }[0m

      at SearchService.searchEnterprises (../src/modules/search/search.service.ts:58:15)
      at SearchController.searchEnterprises (../src/modules/search/search.controller.ts:13:34)
      at ../node_modules/@nestjs/core/router/router-execution-context.js:46:28
      at ../node_modules/@nestjs/core/router/router-proxy.js:9:17

{"level":"info","message":{"duration":"38ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/enterprises?page=1&limit=10","userAgent":""},"timestamp":"2026-01-07T15:24:23.856Z"}
{"level":"info","message":{"duration":"15ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/popular","userAgent":""},"timestamp":"2026-01-07T15:24:23.922Z"}
{"level":"info","message":{"duration":"21ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/search/featured","userAgent":""},"timestamp":"2026-01-07T15:24:23.985Z"}
PASS test/search.e2e-spec.ts
  Search (e2e)
    /v1/search/enterprises (GET)
      Î“ÃªÃœ should search enterprises (119 ms)
      Î“ÃªÃœ should search enterprises with query (106 ms)
      Î“ÃªÃœ should search enterprises with pagination (84 ms)
    /v1/search/popular (GET)
      Î“ÃªÃœ should get popular enterprises (57 ms)
    /v1/search/featured (GET)
      Î“ÃªÃœ should get featured enterprises (62 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"28ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories","userAgent":""},"timestamp":"2026-01-07T15:24:31.099Z"}
{"level":"info","message":{"duration":"12ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories?page=1&limit=5","userAgent":""},"timestamp":"2026-01-07T15:24:31.160Z"}
{"level":"info","message":{"duration":"10ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/all","userAgent":""},"timestamp":"2026-01-07T15:24:31.213Z"}
{"level":"info","message":{"duration":"11ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/categories/test-category","userAgent":""},"timestamp":"2026-01-07T15:24:31.261Z"}
PASS test/categories.e2e-spec.ts (7.248 s)
  Categories (e2e)
    /v1/categories (GET)
      Î“ÃªÃœ should get categories list with pagination (82 ms)
      Î“ÃªÃœ should get categories with custom pagination (55 ms)
    /v1/categories/all (GET)
      Î“ÃªÃœ should get all categories without pagination (50 ms)
    /v1/categories/:slug (GET)
      Î“ÃªÃœ should get category by slug (50 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"23ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities","userAgent":""},"timestamp":"2026-01-07T15:24:35.841Z"}
{"level":"info","message":{"duration":"16ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities?page=1&limit=5","userAgent":""},"timestamp":"2026-01-07T15:24:35.935Z"}
{"level":"info","message":{"duration":"23ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/all","userAgent":""},"timestamp":"2026-01-07T15:24:36.004Z"}
{"level":"info","message":{"duration":"41ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/cities/test-city","userAgent":""},"timestamp":"2026-01-07T15:24:36.147Z"}
PASS test/cities.e2e-spec.ts
  Cities (e2e)
    /v1/cities (GET)
      Î“ÃªÃœ should get cities list with pagination (79 ms)
      Î“ÃªÃœ should get cities with custom pagination (89 ms)
    /v1/cities/all (GET)
      Î“ÃªÃœ should get all cities without pagination (100 ms)
    /v1/cities/:slug (GET)
      Î“ÃªÃœ should get city by slug (119 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"33ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health","userAgent":""},"timestamp":"2026-01-07T15:24:40.970Z"}
{"level":"info","message":{"duration":"57ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/ready","userAgent":""},"timestamp":"2026-01-07T15:24:41.158Z"}
{"level":"info","message":{"duration":"21ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1/health/live","userAgent":""},"timestamp":"2026-01-07T15:24:41.240Z"}
PASS test/health.e2e-spec.ts (5.073 s)
  Health (e2e)
    /v1/health (GET)
      Î“ÃªÃœ should return health status (140 ms)
    /v1/health/ready (GET)
      Î“ÃªÃœ should return readiness status (129 ms)
    /v1/health/live (GET)
      Î“ÃªÃœ should return liveness status (86 ms)

  console.log
    DEBUG: JwtStrategy constructor using secret (prefix): test-...

      at new JwtStrategy (../src/modules/auth/strategies/jwt.strategy.ts:18:13)
          at async Promise.all (index 4)
          at async Promise.all (index 13)

{"level":"info","message":{"duration":"9ms","ip":"::ffff:127.0.0.1","method":"GET","statusCode":200,"url":"/v1","userAgent":""},"timestamp":"2026-01-07T15:24:46.268Z"}
PASS test/app.e2e-spec.ts
  AppController (e2e)
    Î“ÃªÃœ /v1 (GET) (59 ms)

Test Suites: 4 failed, 11 passed, 15 total
Tests:       53 failed, 186 passed, 239 total
Snapshots:   0 total
Time:        113.215 s
Ran all test suites.
